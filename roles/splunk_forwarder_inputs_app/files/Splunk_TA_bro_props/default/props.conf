[source::...bro.*.log]
SHOULD_LINEMERGE = false
#TRUNCATE = false
TRUNCATE = 1000000
MAX_TIMESTAMP_LOOKAHEAD = 20
TIME_FORMAT = %s.%6N
TRANSFORMS-BroAutoType = BroAutoType, TrashComments, BroRouteIndex
INDEXED_EXTRACTIONS = TSV
FIELD_HEADER_REGEX = ^#fields\t(.*)
FIELD_DELIMITER = \t
FIELD_QUOTE = "

# index-time operations to dynamically extract fields based on the log
# header and rename the sourcetype (bro_conn, bro_http, bro_smtp, etc).
[bro]
SHOULD_LINEMERGE = false
#TRUNCATE = false
TRUNCATE = 1000000
MAX_TIMESTAMP_LOOKAHEAD = 20
TIME_FORMAT = %s.%6N
TRANSFORMS-BroAutoType = BroAutoType, TrashComments, BroRouteIndex
INDEXED_EXTRACTIONS = TSV
FIELD_HEADER_REGEX = ^#fields\t(.*)
FIELD_DELIMITER = \t
FIELD_QUOTE = "


# search-time operations to enrich bro logs.
# Match all bro_* sourcetypes.
[(?::){0}bro_*]
SHOULD_LINEMERGE = false
#TRUNCATE = false
TRUNCATE = 1000000

MAX_TIMESTAMP_LOOKAHEAD = 20
TIME_FORMAT = %s.%6N

LOOKUP-LookupTCFlag    = LookupTCFlag TC OUTPUT flag
LOOKUP-LookupAction    = bro_action_lookup status OUTPUT action
LOOKUP-LookupConnSate  = LookupConnSate conn_state OUTPUT conn_state_meaning, action
LOOKUP-LookupTransport = bro_transport_lookup sourcetype OUTPUT transport
LOOKUP-VendorInfo      = bro_vendor_info_lookup sourcetype OUTPUT vendor,product

REPORT-bytes_from_resp_size_int = bytes_from_resp_size_int
REPORT-file_size_as_bytes       = bytes_from_file_size_int
REPORT-get_bytes_for_bro_conn   = bytes_in_int, bytes_out_int

EVAL-bytes = bytes_in + bytes_out

###############
# CIM TAGGING #
###############
#FIELDALIAS-arg =
#FIELDALIAS-client_header_names 
#FIELDALIAS-conn_state
FIELDALIAS-content_len = content_len AS message_size
#FIELDALIAS-date =
FIELDALIAS-dest = id_resp_h AS dest
FIELDALIAS-dest_ip = id_resp_h AS dest_ip
FIELDALIAS-dest_port = id_resp_p AS dest_port
#FIELDALIAS-duration
FIELDALIAS-dvc = host AS dvc
FIELDALIAS-emailAddress = emailAddress as sender
#FIELDALIAS-excerpt =
#FIELDALIAS-extraction_file = 
FIELDALIAS-filename = filename AS file_name
#FIELDALIAS-file_size  =
#FIELDALIAS-first_received =
#FIELDALIAS-from =
#FIELDALIAS-helo =
#FIELDALIAS-history
FIELDALIAS-host = host AS dest_host
#FIELDALIAS-info_code 
#FIELDALIAS-info_msg 
#FIELDALIAS-in_reply_to =
#FIELDALIAS-last_reply =
#FIELDALIAS-local_orig
FIELDALIAS-mailfrom = mailfrom AS sender
#FIELDALIAS-md5 = 
FIELDALIAS-method = method AS http_method
#FIELDALIAS-mime_desc =
#FIELDALIAS-mime_type =
FIELDALIAS-mime_type = mime_type AS attachment_type
FIELDALIAS-mime_type = mime_type AS http_content_type
#FIELDALIAS-missed_bytes
FIELDALIAS-msg_id = msg_id AS message_id
#FIELDALIAS-orig_bytes = orig_bytes AS bytes_out
#FIELDALIAS-orig_ip_bytes
FIELDALIAS-orig_pkts = orig_pkts AS packets_out
#FIELDALIAS-password =
#FIELDALIAS-path =
FIELDALIAS-proto = proto AS transport
FIELDALIAS-proxied = proxied AS product
FIELDALIAS-qclass_name = qclass_name AS record_class
FIELDALIAS-qtype_name  = qtype_name  AS record_type
FIELDALIAS-query = query as url
FIELDALIAS-rcptto = rcptto AS recipients
FIELDALIAS-referrer = referrer AS http_referrer
#FIELDALIAS-reply_code =
#FIELDALIAS-reply_msg =
#FIELDALIAS-reply_to =
FIELDALIAS-request_body_len = request_body_len AS bytes_out
#FIELDALIAS-resp_bytes = resp_bytes AS bytes_in
#FIELDALIAS-resp_ip_bytes
FIELDALIAS-response_body_len = response_body_len AS bytes_in
FIELDALIAS-resp_pkts = resp_pkts AS packets_in
#FIELDALIAS-second_received =
#FIELDALIAS-server_header_names
FIELDALIAS-service= service AS app
FIELDALIAS-src = id_orig_h AS src
FIELDALIAS-src_ip = id_orig_h AS src_ip
FIELDALIAS-src_port = id_orig_p AS src_port
FIELDALIAS-status_code = status_code AS status
#FIELDALIAS-status_msg 
FIELDALIAS-subject = subject AS message_subject
#FIELDALIAS-tags =
FIELDALIAS-TC  = TC AS flag
#FIELDALIAS-to =
#FIELDALIAS-trans_depth = 
#FIELDALIAS-ts = 
#FIELDALIAS-tunnel_parents
FIELDALIAS-uid = uid AS flow_id
FIELDALIAS-uri  = uri AS url
#FIELDALIAS-user =
FIELDALIAS-user_agent = user_agent AS http_user_agent
FIELDALIAS-username = username as user
#FIELDALIAS-x_originating_ip = 
