#--------------------------------  CISCO ROUTERS ------------------------------------------------
destination d_routers { file ("/syslog/ROUTERS/$SOURCEIP/$SOURCEIP.log"
                           owner(syslog-ng) group(splunk) perm(0755) dir_perm(0755) create_dirs(yes) );
                            };
filter f_routers {
                           match("%CDP-" value ("MSGHDR"))              or match("%CDP-" value ("MSG"))
                        or match("%LINK-" value ("MSGHDR"))             or match("%LINK-" value ("MSG"))
                        or match("%C4K_EBM-" value ("MSGHDR"))          or match("%C4K_EBM-" value ("MSG"))
                        or match("%SFF" value ("MSGHDR"))               or match("%SFF" value ("MSG"))
                        or match("%IP-" value ("MSGHDR"))               or match("%IP-" value ("MSG"))
                        or match("%SEC-" value ("MSGHDR"))              or match("%SEC-" value ("MSG"))
                        or match("%C3800_" value ("MSGHDR"))            or match("%C3800_" value ("MSG"))
                        or match("%SEC-" value ("MSGHDR"))              or match("%SEC-" value ("MSG"))
                        or match("%ATM_" value ("MSGHDR"))              or match("%ATM_" value ("MSG"))
                        or match("%MV64340_" value ("MSGHDR"))          or match("%MV64340_" value ("MSG"))
                        or match("%EARL_" value ("MSGHDR"))             or match("%EARL_" value ("MSG"))
                        or match("%ILPOWER-" value ("MSGHDR"))          or match("%ILPOWER-" value ("MSG"))
                        or match("%PM-" value ("MSGHDR"))               or match("%PM-" value ("MSG"))
                        or match("%DIALER-" value ("MSGHDR"))           or match("%DIALER-" value ("MSG"))
                        or match("%SSH-" value ("MSGHDR"))              or match("%SSH-" value ("MSG"))
                        or match("%FW-" value ("MSGHDR"))               or match("%FW-" value ("MSG"))
                        or match("%RCMD-" value ("MSGHDR"))             or match("%RCMD-" value ("MSG"))
                        or match("%IP_" value ("MSGHDR"))               or match("%IP_" value ("MSG"))
                        or match("%SSH-" value ("MSGHDR"))              or match("%SSH-" value ("MSG"))

                        or match(" cst: " value ("MSGHDR"))             or match(" cst: " value ("MSG"))
#                       or match("UTC%" value ("MSGHDR"))               or match("UTC%" value ("MSG"))
                        or match("-Traceback=" value ("MSGHDR"))        or match("-Traceback=" value ("MSG"))
                        or match("%CRYPTO-" value ("MSGHDR"))           or match("%CRYPTO-" value ("MSG"))
                        or match("%DUAL-" value ("MSGHDR"))             or match("%DUAL-" value ("MSG"))
                        or match("%SYS-" value ("MSGHDR"))              or match("%SYS-" value ("MSG"))

                        or match("%LINEPROTO" value ("MSGHDR"))         or match("%LINEPROTO" value ("MSG"))
                        or match("connection id=" value ("MSGHDR"))     or match("connection id=" value ("MSG"))
                        or match("%VPN_HW" value ("MSGHDR"))            or match("%VPN_HW" value ("MSG"))
                        or match("%HSRP_ENGINE" value ("MSGHDR"))       or match("%HSRP_ENGINE" value ("MSG"))
                        or match("%BGP-" value ("MSGHDR"))              or match("%BGP-" value ("MSG"))
                        or match("%WCCP-" value ("MSGHDR"))             or match("%WCCP-" value ("MSG"))
                        or match("%CONTROLLER-" value ("MSGHDR"))       or match("%CONTROLLER-" value ("MSG"))
                        or match("ISAKMP:" value ("MSGHDR"))            or match("ISAKMP:" value ("MSG"))                               #VPN routers (Extranet)
                        or netmask ("10.9.16.14/32")            #mtn-gdc-agg-n7018a-1.emrets.net
                        or netmask ("10.9.24.14/32")            #mtn-gdc-agg-n7018b-1.emrets.net
                        or netmask ("10.8.16.14/32")            #stl-gdc-agg-n7018a-1.emrets.net
                        or netmask ("10.8.24.14/32")            #stl-gdc-agg-n7018b-1.emrets.net
			or netmask ("10.8.16.70/32")
			or netmask ("10.11.16.70/32")
			or netmask ("10.10.16.70/32")

                        and not match("TCP_MISS" value ("MSGHDR"))                      #Websense event
                        and not match("MSWinEventLog" value ("MSGHDR"))                 #Windows event

                        and not match("%ASA-" value ("MSG"))
                        and not match("%FWSM-" value ("MSG"))
                        and not match ("%PIX" value ("MSG"))

                        and not match("%ACE-" value ("MSGHDR"))
                        and not match("%WAAS-" value ("MSGHDR"))

                        and not match("syslog" value ("MSGHDR"))
                        and not match("snmpd" value ("MSGHDR"))
                        and not match("sshd" value ("MSGHDR"))
                        and not match("pam_unix" value ("MSGHDR"))
                        and not match("CRON" value ("MSGHDR"))
                        and not match("Connection failed; " value ("MSGHDR"))           #Unix event
                        and not match("kernal: " value ("MSGHDR"))                      #Unix event
                        and not match("su " value ("MSGHDR"));                          #Unit event

};
log {source(s_network); filter(f_routers);destination(d_routers);};
#---------------------------------------------------------------------------------------------------  

